# Generated by Butane; do not edit
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: infra
  name: 99-infra-localvm-mount
spec:
  config:
    ignition:
      version: 3.4.0
    systemd:
      units:
        - contents: |
            [Unit]
            Description=Init /var/local-vm once
            ConditionPathExists=!/var/local-vm/.inited
            After=systemd-udev-settle.service
            Before=local-vm.mount
            [Service]
            Type=oneshot
            ExecStart=/usr/bin/bash -c '\
              wipefs -a /dev/disk/by-path/pci-0000:00:01.1-ata-2.1 && \
              mkfs.xfs -f /dev/disk/by-path/pci-0000:00:01.1-ata-2.1 && \
              mkdir -p /var/local-vm && \
              touch /var/local-vm/.inited'
            [Install]
            WantedBy=local-vm.mount
          enabled: true
          name: prepare-localvm.service
        - contents: |
            [Unit]
            Description=/var/local-vm XFS disk
            After=prepare-localvm.service
            ConditionPathExists=/dev/disk/by-path/pci-0000:00:01.1-ata-2.1
            [Mount]
            What=/dev/disk/by-path/pci-0000:00:01.1-ata-2.1
            Where=/var/local-vm
            Type=xfs
            Options=nodev,defaults,context=system_u:object_r:container_file_t:s0
            [Install]
            WantedBy=local-fs.target
          enabled: true
          name: var-local\x2dvm.mount
