apiVersion: v1
kind: PersistentVolume
metadata:
  name: test-pod-pv-0
spec:
  capacity:
    storage: 100Mi
  volumeMode: Filesystem
  accessModes:
  - ReadWriteOnce
  persistentVolumeReclaimPolicy: Delete
  storageClassName: test-sc
  local:
    path: /var/lib/containers/test-pod-pv-0
  nodeAffinity:
    required:
      nodeSelectorTerms:
      - matchExpressions:
        - key: kubernetes.io/hostname
          operator: In
          values:
          - skt-bssocpdawkr01.devocp1-416.sktelecom.com
          - skt-bssocpdawkr02.devocp1-416.sktelecom.com
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: test-pod-pv-1
spec:
  capacity:
    storage: 100Mi
  volumeMode: Filesystem
  accessModes:
  - ReadWriteOnce
  persistentVolumeReclaimPolicy: Delete
  storageClassName: test-sc
  local:
    path: /var/lib/containers/test-pod-pv-1
  nodeAffinity:
    required:
      nodeSelectorTerms:
      - matchExpressions:
        - key: kubernetes.io/hostname
          operator: In
          values:
          - skt-bssocpdawkr01.devocp1-416.sktelecom.com
          - skt-bssocpdawkr02.devocp1-416.sktelecom.com
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: statefulset-pod
  namespace: test
  labels:
    test: test
spec:
  replicas: 2
  selector:
    matchLabels:
      test: test
  template:
    metadata:
      labels:
        test: test
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/hostname
                operator: In
                values:
                - skt-bssocpdawkr01.devocp1-416.sktelecom.com
                - skt-bssocpdawkr02.devocp1-416.sktelecom.com
      containers:
      - name: test-con
        image: skt-bssocpdargst.devocp1-416.sktelecom.com:5016/rhel-stkang:v2
#        image: sktbss-external-registry.sktelecom.com:5000/centos/centos:latest
        command:
          - /bin/sh
          - "-c"
          - "sleep 60m"
        volumeMounts:
        - name: test123-pod-pvc
          mountPath: /mnt
        securityContext:
          allowPrivilegedEscalation: false
  volumeClaimTemplates:
  - metadata:
      name: test123-pod-pvc
    spec:
      accessModes: [ "ReadWriteOnce" ]
      storageClassName: "test-sc"
      resources:
        requests:
          storage: 100Mi
